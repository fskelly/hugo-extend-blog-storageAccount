<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>
  
     Inactive Incidents–E-mail assigned to User | 
    Fletcher&#39;s Tech Blog
  
</title><meta name="description" content="A day in the life of a Cloud Engineer."><meta name="author" content="Fletcher Kelly">

<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png " sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0c344b">
<link rel="icon" href="/favicon.ico">


    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism.min.css">
    



    
        
            <link rel="stylesheet" href="/dist/main.37ab3f61b95417873748.min.css">
        
    




<link rel="canonical" href="https://cloudadventures.fskelly.com/2012/10/10/inactive-incidentse-mail-assigned-to-user/"><meta property="og:title" content="Inactive Incidents–E-mail assigned to User" />
<meta property="og:description" content="Just recently I was looking for a way to notify users about Inactive incidents as I have some departments that tend to ignore their work items and an e-mail about their “untouched” incidents seems to motivate them. So after some searching I found this scriptfrom Andreas BaumgartenPlease note : I only modified this script to extend its use to other Statuses to be monitored. All credit for the script goes entirely to Andreas BaumgartenCode is below[sourcecode language=”powershell”]# Configure Last Modified Days Before" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloudadventures.fskelly.com/2012/10/10/inactive-incidentse-mail-assigned-to-user/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2012-10-10T07:34:02+00:00" />
<meta property="article:modified_time" content="2012-10-10T07:34:02+00:00" />

<meta itemprop="name" content="Inactive Incidents–E-mail assigned to User">
<meta itemprop="description" content="Just recently I was looking for a way to notify users about Inactive incidents as I have some departments that tend to ignore their work items and an e-mail about their “untouched” incidents seems to motivate them. So after some searching I found this scriptfrom Andreas BaumgartenPlease note : I only modified this script to extend its use to other Statuses to be monitored. All credit for the script goes entirely to Andreas BaumgartenCode is below[sourcecode language=”powershell”]# Configure Last Modified Days Before"><meta itemprop="datePublished" content="2012-10-10T07:34:02+00:00" />
<meta itemprop="dateModified" content="2012-10-10T07:34:02+00:00" />
<meta itemprop="wordCount" content="513">
<meta itemprop="keywords" content="Assigned to user,Assignedto,e-mail,notification,reminder,Service Manager,ServiceManager,workflow," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Inactive Incidents–E-mail assigned to User"/>
<meta name="twitter:description" content="Just recently I was looking for a way to notify users about Inactive incidents as I have some departments that tend to ignore their work items and an e-mail about their “untouched” incidents seems to motivate them. So after some searching I found this scriptfrom Andreas BaumgartenPlease note : I only modified this script to extend its use to other Statuses to be monitored. All credit for the script goes entirely to Andreas BaumgartenCode is below[sourcecode language=”powershell”]# Configure Last Modified Days Before"/>

</head>
<body>
    
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://cloudadventures.fskelly.com">Fletcher&#39;s Tech Blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
            
            </ul>
        </div>
    </div>
</nav>


    
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="meta text-muted mb-3">
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">October 10, 2012</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>513 words</span>
                            <span><i class="fas fa-clock mr-2"></i>3 mins read</span>
                        </div>

                        <h1>Inactive Incidents–E-mail assigned to User</h1>

                        
                    </div>
                </div><div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="content">
                            <p><!-- raw HTML omitted -->Just recently I was looking for a way to notify users about Inactive incidents as I have some departments that tend to ignore their work items and an e-mail about their “untouched” incidents seems to motivate them. So after some searching I found <!-- raw HTML omitted -->this script<!-- raw HTML omitted --> from <!-- raw HTML omitted -->Andreas Baumgarten<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Please note : I only modified this script to extend its use to other Statuses to be monitored. All credit for the script goes entirely to <!-- raw HTML omitted -->Andreas Baumgarten<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Code is below<!-- raw HTML omitted --></p>
<p>[sourcecode language=”powershell”]# Configure Last Modified Days Before<br>
$ModifiedBefore = 3</p>
<p>#Configure Incident Status<br>
$IncidentStatus = ‘Active’</p>
<p># Configure your mail server, the recipient and the sender of the mail<br>
# $smtphost=”mailserver.yourdomain.local”<br>
# $from=”mail@yourdomain.local”</p>
<p>$smtphost=”Mailserver.demo.local”<br>
$from=”Helpdesk@demo.local”</p>
<p># Send-Mail function<br>
function Send-Mail<br>
{<br>
Param($From,$To,$Subject,$Body)<br>
$smtp = new-object system.net.mail.smtpClient($smtphost)<br>
$mail = new-object System.Net.Mail.MailMessage<br>
$mail.from= $From<br>
$mail.to.add($To)<br>
$mail.subject= $Subject<br>
$mail.body= $Body<br>
$mail.isbodyhtml=$true<br>
$smtp.send($Mail)<br>
}</p>
<p># Some other variables<br>
$BeforeDate = (Get-Date).AddDays(-$ModifiedBefore).ToString(&ldquo;MM/dd/yyy HH:mm:ss&rdquo;)<br>
$Status = Get-SCSMEnumeration IncidentStatusEnum.$IncidentStatus$<br>
$AssignedUserObjectRelClass = Get-SCSMRelationshipClass System.WorkItemAssignedToUser<br>
$IncidentClass = Get-SCSMClass -name System.WorkItem.Incident$</p>
<p>#Get all incidents last modfied xy days before<br>
$Incidents= @(Get-SCSMObject -Class $IncidentClass | Where {($_.Status -eq $Status -AND $_.LastModified -lt $BeforeDate)})</p>
<p>If ($Incidents.count -gt 0)<br>
{</p>
<p>#Get all assigned incidents from list<br>
foreach ($Incident in $Incidents)<br>
{<br>
# Get AssignedToUser<br>
$AssignedUser = Get-SCSMRelatedObject -SMObject $Incident -Relationship $AssignedUserObjectRelClass</p>
<p># Incidents AssignedTo is not NULL<br>
If ($AssignedUser.Displayname -ne $NULL)<br>
{<br>
#Get email adress of AssignedToUser<br>
$EndPoint = Get-SCSMRelatedObject -SMObject $assignedUser -Relationship $UserPref|?{$_.ChannelName -like ‘*SMTP’}<br>
$Sendto = $Endpoint.Targetaddress</p>
<p>#Create Output<br>
$Output = ‘This Incident has been inactive for ‘ + $ModifiedBefore + ‘ day(s): <!-- raw HTML omitted -->’ + $Incident.ID + ‘ – ‘ + $Incident.Title + ‘ – Last Modified: ‘ + $Incident.Lastmodified<br>
$Output<br>
#Send email<br>
$To = $Sendto<br>
$Subject = ‘Inactive incident for ‘ + $ModifiedBefore + ‘ day(s): ‘ + $Incident.Id + ‘ ‘ + $Incident.Title<br>
$Body = $Output<br>
Send-Mail $From $to $Subject $Body<br>
}<br>
}<br>
}</p>
<p>Remove-Module SMlets -force [/sourcecode]</p>
<p><!-- raw HTML omitted -->Okay, so now that the code is there, I had to make some modifications in order for the Code to work with “NON-DEFAULT” Incident Statuses. I have created some additional Pending statuses.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->The key line in this code is<!-- raw HTML omitted --></p>
<p>[sourcecode language=”powershell”]Configure Incident Status<br>
$IncidentStatus = ‘Active'[/sourcecode]</p>
<p><!-- raw HTML omitted -->and<!-- raw HTML omitted --></p>
<p>[sourcecode language=”powershell”]$Status = Get-SCSMEnumeration IncidentStatusEnum.$IncidentStatus$[/sourcecode]</p>
<p><!-- raw HTML omitted -->This allows you specify the Status. However if you use additional “NON-DEFAULT” statuses, this would need to be modified to suit your needs. You would need to modify the line of code to read as follows.<!-- raw HTML omitted --></p>
<p>[sourcecode language=”powershell”]$IncidentStatus = ‘Enum.847741a452db4d529741005ea73aead8′[/sourcecode]</p>
<p><!-- raw HTML omitted -->and <!-- raw HTML omitted --></p>
<p>[sourcecode language=”powershell”]$Status = Get-SCSMEnumeration $IncidentStatus$[/sourcecode]</p>
<p><!-- raw HTML omitted -->You will notice the change of $IncidentStatus to a “ENUM” Value as this is a “NON-DEFAULT” value, you need to use the ENUM value. This can be gotten by using the following with SMLets<!-- raw HTML omitted --></p>
<p>[sourcecode language=”powershell”]Get-SCSMEnumeration | Format-list | out-file[/sourcecode]</p>
<p><!-- raw HTML omitted -->Below, is a screenshot to help illustrate this further.<!-- raw HTML omitted --></p>
<p><a href="http://fskelly.files.wordpress.com/2012/10/enumsearch11.jpg"><!-- raw HTML omitted --></a></p>
<p><!-- raw HTML omitted -->Once you have a list of all your Enumerations, then search for the required value, for example “Pending – Waiting for 3rd Party”, you will then see a “Name” value and that whole string is your ENUM value.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->You will also see that the $Status line has been changed to cater for the ENUM value.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Modify to meet your needs and create a workflow if you want to.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Follow me.<!-- raw HTML omitted --></p>
<p><a href="http://www.facebook.com/fletcher.kelly"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></a><a href="http://twitter.com/#!/fskelly"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></a></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>

                        </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/assigned-to-user">
                                    <i class="fas fa-tag mr-2"></i>Assigned to user
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/assignedto">
                                    <i class="fas fa-tag mr-2"></i>Assignedto
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/e-mail">
                                    <i class="fas fa-tag mr-2"></i>e-mail
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/notification">
                                    <i class="fas fa-tag mr-2"></i>notification
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/reminder">
                                    <i class="fas fa-tag mr-2"></i>reminder
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/service-manager">
                                    <i class="fas fa-tag mr-2"></i>Service Manager
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/servicemanager">
                                    <i class="fas fa-tag mr-2"></i>ServiceManager
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/workflow">
                                    <i class="fas fa-tag mr-2"></i>workflow
                                </a></div><ul class="share nav my-3 justify-content-end">
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://twitter.com/intent/tweet?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2012%2f10%2f10%2finactive-incidentse-mail-assigned-to-user%2f&text=Inactive%20Incidents%e2%80%93E-mail%20assigned%20to%20User">
              <i class="fa-fw fab fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2012%2f10%2f10%2finactive-incidentse-mail-assigned-to-user%2f&title=Inactive%20Incidents%e2%80%93E-mail%20assigned%20to%20User">
                <i class="fa-fw fab fa-linkedin-in"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fcloudadventures.fskelly.com%2f2012%2f10%2f10%2finactive-incidentse-mail-assigned-to-user%2f&t=Inactive%20Incidents%e2%80%93E-mail%20assigned%20to%20User">
                <i class="fa-fw fab fa-facebook-f"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://reddit.com/submit?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2012%2f10%2f10%2finactive-incidentse-mail-assigned-to-user%2f&title=Inactive%20Incidents%e2%80%93E-mail%20assigned%20to%20User">
                <i class="fa-fw fab fa-reddit-alien"></i>
            </a>
        </li>
    </nav>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        
                    </div>
                </div><div class="row justify-content-center my-3">
                    <div class="col-lg-8">
                        <div id="commento"></div>
                        <script src="https://commento.io"></script>
                    </div>
                </div></article>
        </div>
    </div>

    <div class="related-content row mt-5 row-cols-1 row-cols-lg-3"><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2012/06/26/why-is-my-service-manager-so-slow/" class="d-block"><div class="card-body">
            <h4 class="card-title">Why is my Service Manager so slow?</h4>
            <p class="card-text text-muted text-uppercase">June 26, 2012</p>
            <div class="card-text">
                So, I have been running Service Manager for quite some time now. From SCSM 2010 to SCSM SP1 and most of the CU’s before I upgraded to SCSM 2012 Beta and RC and then to RTM (with the help of a Microsoft TAP Program). Service Manager is now quite entrenched in our business and has been running quite well for a very long time. However, a little while ago we began to experience performance issues with the Console and the logging of calls and the application of Workflows.
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2012/07/09/service-requests-re-assignment-notification/" class="d-block"><div class="card-body">
            <h4 class="card-title">Service Requests – Re-assignment notification</h4>
            <p class="card-text text-muted text-uppercase">July 9, 2012</p>
            <div class="card-text">
                So, in an effort to get my business ready for Service Requests as we use mainly Incidents and we are beginning our journey into Service Requests and differentiating between Service Requests (day to day operations) and Incidents (something is broken), I needed to reproduce a workflow to notify the “AssignedToUser” when a new Service Request is assigned to him or her. I already had a downloaded Management Pack for Incident Re-assignment notifications which was modified for my purposes, so this was a good place to start.
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2012/04/30/upgrading-from-scsm-2010-scsm-2012-pre-rtm-to-scsm-2012-rtm/" class="d-block"><div class="card-body">
            <h4 class="card-title">Upgrading from SCSM 2010 / SCSM 2012 PRE-RTM to SCSM 2012 RTM</h4>
            <p class="card-text text-muted text-uppercase">April 30, 2012</p>
            <div class="card-text">
                So, You are now ready to take the plunge and upgrade to SCSM 2012 RTM as it now “publically” available.
There is great documentation, obviously, on TECHNET. I have however found out a few other things which will helpfully make your transition a little easier. I have found that the following can cause some complications and how to “mitigate” these if you will.
Service Manager 2010
Connectors – Please make sure that your connectors are NOT running while you do the upgrade, the upgrade will work, however your connectors will run and attempt to catch up with itself.
            </div>
        </div>
    </a>
</div>

            </div></div>
</main>


    <footer class="footer text-center bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://cloudadventures.fskelly.com/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                            <a href="https://github.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://linkedin.com/in/fletcherkelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://twitter.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-muted">
                    
                        Copyright © 2019–2021, Fletcher Kelly; all rights reserved.
                    
                </p>

                <p class="text-muted">
                Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with <a href="https://github.com/puresyntax71/hugo-theme-chunky-poster" target="_blank">Chunky Poster</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    
    
        
            <script src="/dist/main.d608eadfe5ac0688902e.min.js"></script>
        
    



<script>
    window.Prism = window.Prism || {};
    window.Prism.manual = true;
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>







    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-XXXX', 'auto');
	
	ga('send', 'pageview');
}
</script>
</body>
</html>
