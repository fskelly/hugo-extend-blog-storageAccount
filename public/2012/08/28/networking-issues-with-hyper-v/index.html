<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>
  
     Networking issues with Hyper-V | 
    Fletcher&#39;s Tech Blog
  
</title><meta name="description" content="A day in the life of a Cloud Engineer."><meta name="author" content="Fletcher Kelly">

<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png " sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0c344b">
<link rel="icon" href="/favicon.ico">


    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism.min.css">
    



    
        
            <link rel="stylesheet" href="/dist/main.37ab3f61b95417873748.min.css">
        
    




<link rel="canonical" href="https://cloudadventures.fskelly.com/2012/08/28/networking-issues-with-hyper-v/"><meta property="og:title" content="Networking issues with Hyper-V" />
<meta property="og:description" content="Just recently I was running into some very strange issues with my Hyper-V Cluster. we have numerous NICs to allow for redundancy and better throughput for our clustered environment. We have a total of 11 NICs on our server to cater for Guest LAN, iSCSI, guest iSCSI (as we present SAN storage directly to the Guests), HeartBeat and Live Migration. So, I was getting a little concerned when I was performing maintenance and/or “Live Migrations” and my VMs were losing network connectivity both on LAN connections and iSCSI connections which was causing major issues with my VMs needing external storage as this was mostly SQL or file shares." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloudadventures.fskelly.com/2012/08/28/networking-issues-with-hyper-v/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2012-08-28T13:35:56+00:00" />
<meta property="article:modified_time" content="2012-08-28T13:35:56+00:00" />

<meta itemprop="name" content="Networking issues with Hyper-V">
<meta itemprop="description" content="Just recently I was running into some very strange issues with my Hyper-V Cluster. we have numerous NICs to allow for redundancy and better throughput for our clustered environment. We have a total of 11 NICs on our server to cater for Guest LAN, iSCSI, guest iSCSI (as we present SAN storage directly to the Guests), HeartBeat and Live Migration. So, I was getting a little concerned when I was performing maintenance and/or “Live Migrations” and my VMs were losing network connectivity both on LAN connections and iSCSI connections which was causing major issues with my VMs needing external storage as this was mostly SQL or file shares."><meta itemprop="datePublished" content="2012-08-28T13:35:56+00:00" />
<meta itemprop="dateModified" content="2012-08-28T13:35:56+00:00" />
<meta itemprop="wordCount" content="405">
<meta itemprop="keywords" content="Failover Cluster,hyper-v,NIC,nics,Virtual Switches," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Networking issues with Hyper-V"/>
<meta name="twitter:description" content="Just recently I was running into some very strange issues with my Hyper-V Cluster. we have numerous NICs to allow for redundancy and better throughput for our clustered environment. We have a total of 11 NICs on our server to cater for Guest LAN, iSCSI, guest iSCSI (as we present SAN storage directly to the Guests), HeartBeat and Live Migration. So, I was getting a little concerned when I was performing maintenance and/or “Live Migrations” and my VMs were losing network connectivity both on LAN connections and iSCSI connections which was causing major issues with my VMs needing external storage as this was mostly SQL or file shares."/>

</head>
<body>
    
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://cloudadventures.fskelly.com">Fletcher&#39;s Tech Blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
            
            </ul>
        </div>
    </div>
</nav>


    
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="meta text-muted mb-3">
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">August 28, 2012</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>405 words</span>
                            <span><i class="fas fa-clock mr-2"></i>2 mins read</span>
                        </div>

                        <h1>Networking issues with Hyper-V</h1>

                        
                    </div>
                </div><div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="content">
                            <p><!-- raw HTML omitted -->Just recently I was running into some very strange issues with my Hyper-V Cluster. we have numerous NICs to allow for redundancy and better throughput for our clustered environment. We have a total of 11 NICs on our server to cater for Guest LAN, iSCSI, guest iSCSI (as we present SAN storage directly to the Guests), HeartBeat and Live Migration. So, I was getting a little concerned when I was performing maintenance and/or “Live Migrations” and my VMs were losing network connectivity both on LAN connections and iSCSI connections which was causing major issues with my VMs needing external storage as this was mostly SQL or file shares. So time to start troubleshooting.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->First stop would obviously be the NICs on the hosts and I spent some time checking all the NICs and ensuring they are cabled correctly. Not the world’s easiest job considering the amount of network cables we have in our cabinets. We have numerous Hyper-V nodes, all with 11 NICs excluding Management and iDRAC. So we are talking hundreds of cables. However, I trudged through it and put a check mark next to it – no issues there.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->So, several hours and days later and cursing and swearing all the network cables, velcro and cable ties in my cabinets, it was time to move on. So, it was NOT a physical network issue. Time to give a little further. My next stop was the Hypervisor layer.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->I start diving through the Hypervisor and I found “gold” here, (I actually mean the cause of my issue). Enter Hyper-V Networking. Please allow me to clarify this. The networking was not the issue but what someone/something had done, the truth here will never be known. I found that I had duplicate Virtual Network created. <!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->So, for each physical NIC i had in the server and was using for the Virtualization, I had 2 networks. 1 connected to the “External Network” and here is the kicker, 1 connected to the “PRIVATE” network. So with a little troubleshooting and deal of understanding Virtual Switches, I was able to return my cluster to it’s former 100% redundant glory. After removing ALL the private networks and there were many on all my Nodes, I was able to Live Migrate and patch/maintain to my heart’s content.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Gotta love Virtualization.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Hopefully this will help someone else as well.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->The lesson here is to keep a good eye on your Virtual Environment and always check the basics.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Follow me.<!-- raw HTML omitted --></p>
<p><a href="http://www.facebook.com/fletcher.kelly"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></a> <!-- raw HTML omitted --><!-- raw HTML omitted --><a href="http://twitter.com/#!/fskelly"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></a></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>

                        </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/failover-cluster">
                                    <i class="fas fa-tag mr-2"></i>Failover Cluster
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/hyper-v">
                                    <i class="fas fa-tag mr-2"></i>hyper-v
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/nic">
                                    <i class="fas fa-tag mr-2"></i>NIC
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/nics">
                                    <i class="fas fa-tag mr-2"></i>nics
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/virtual-switches">
                                    <i class="fas fa-tag mr-2"></i>Virtual Switches
                                </a></div><ul class="share nav my-3 justify-content-end">
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://twitter.com/intent/tweet?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2012%2f08%2f28%2fnetworking-issues-with-hyper-v%2f&text=Networking%20issues%20with%20Hyper-V">
              <i class="fa-fw fab fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2012%2f08%2f28%2fnetworking-issues-with-hyper-v%2f&title=Networking%20issues%20with%20Hyper-V">
                <i class="fa-fw fab fa-linkedin-in"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fcloudadventures.fskelly.com%2f2012%2f08%2f28%2fnetworking-issues-with-hyper-v%2f&t=Networking%20issues%20with%20Hyper-V">
                <i class="fa-fw fab fa-facebook-f"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://reddit.com/submit?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2012%2f08%2f28%2fnetworking-issues-with-hyper-v%2f&title=Networking%20issues%20with%20Hyper-V">
                <i class="fa-fw fab fa-reddit-alien"></i>
            </a>
        </li>
    </nav>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        
                    </div>
                </div><div class="row justify-content-center my-3">
                    <div class="col-lg-8">
                        <div id="commento"></div>
                        <script src="https://commento.io"></script>
                    </div>
                </div></article>
        </div>
    </div>

    <div class="related-content row mt-5 row-cols-1 row-cols-lg-3"><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2012/03/30/adding-a-csv-volume-to-a-cluster/" class="d-block"><div class="card-body">
            <h4 class="card-title">Adding a CSV volume to a Cluster</h4>
            <p class="card-text text-muted text-uppercase">March 30, 2012</p>
            <div class="card-text">
                So, now you are at the point where you need to present a CSV Volume to your cluster.
I have created this guide to make your life a little easier. Doing this is actually quite simple, but there are a few gotchas.
Gotcha 1 : If you create / carve the LUN and forget to allow multiple access, only the first IQN / WWN will be able to access it.
            </div>
        </div>
    </a>
</div>

            </div></div>
</main>


    <footer class="footer text-center bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://cloudadventures.fskelly.com/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                            <a href="https://github.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://linkedin.com/in/fletcherkelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://twitter.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-muted">
                    
                        Copyright © 2019–2021, Fletcher Kelly; all rights reserved.
                    
                </p>

                <p class="text-muted">
                Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with <a href="https://github.com/puresyntax71/hugo-theme-chunky-poster" target="_blank">Chunky Poster</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    
    
        
            <script src="/dist/main.d608eadfe5ac0688902e.min.js"></script>
        
    



<script>
    window.Prism = window.Prism || {};
    window.Prism.manual = true;
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>







    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-XXXX', 'auto');
	
	ga('send', 'pageview');
}
</script>
</body>
</html>
