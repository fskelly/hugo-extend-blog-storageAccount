<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>
  
     powershell | 
    Fletcher&#39;s Tech Blog
  
</title><meta name="description" content="A day in the life of a Cloud Engineer."><meta name="author" content="Fletcher Kelly">

<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png " sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0c344b">
<link rel="icon" href="/favicon.ico">


    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism.min.css">
    



    
        
            <link rel="stylesheet" href="/dist/main.37ab3f61b95417873748.min.css">
        
    




<link rel="canonical" href="https://cloudadventures.fskelly.com/tags/powershell/">
  <link href="https://cloudadventures.fskelly.com/tags/powershell/index.xml" rel="alternate" type="application/rss+xml" title="Fletcher&#39;s Tech Blog">
  <link href="https://cloudadventures.fskelly.com/tags/powershell/index.xml" rel="feed" type="application/rss+xml" title="Fletcher&#39;s Tech Blog"><meta property="og:title" content="powershell" />
<meta property="og:description" content="A day in the life of a Cloud Engineer." />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://cloudadventures.fskelly.com/tags/powershell/" />

<meta itemprop="name" content="powershell">
<meta itemprop="description" content="A day in the life of a Cloud Engineer."><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="powershell"/>
<meta name="twitter:description" content="A day in the life of a Cloud Engineer."/>

</head>
<body>
    
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://cloudadventures.fskelly.com">Fletcher&#39;s Tech Blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
            
            </ul>
        </div>
    </div>
</nav>


    
<main class="list container py-6"><div class="row py-3">
        <div class="col">
            <h3 class="display-4">powershell</h3></div>
    </div><div class="row row-cols-1 row-cols-lg-3">
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/post/2021/expiring-keys-azure-key-vault/" class="d-block"><img data-src="/images/2021/azposh_hua2192da61106921e9d17447b74ab2f46_4646_700x350_fill_q75_box_smart1.jpg" class="card-img-top mx-auto d-block" alt="Expiring Keys and Secrets within Azure Key Vault"><div class="card-body">
            <h4 class="card-title">Expiring Keys and Secrets within Azure Key Vault</h4>
            <p class="card-text text-muted text-uppercase">January 18, 2021</p>
            <div class="card-text">
                I was working with a customer the other day and a fairly simple ask came up, I however could not find an immediate answer within the portal.
How do I check for expiring keys within the Azure KeyVault?
Now being a PowerShell person, I never gave this much thought as for most tasks or actions I perform on the Azure Platform is done through PowerShell, AP, or CLI. So easy enough, however, not everyone knows how to do this in PowerShell.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/post/2019/importance-of-networking-azure/" class="d-block"><img data-src="/images/2019/networking_hu2a9be243c0932c14d4bdbcff8836aa87_178633_700x350_fill_q75_box_smart1.jpg" class="card-img-top mx-auto d-block" alt="Importance of Networking in Azure"><div class="card-body">
            <h4 class="card-title">Importance of Networking in Azure</h4>
            <p class="card-text text-muted text-uppercase">August 7, 2019</p>
            <div class="card-text">
                As a start to this blog post, I think it is important to understand how I see my role as a CSA (Cloud Solution Architect) with my customer. I am primarily a trusted advisor and my customers respect what I have to say, I question and challenge my customers in a constructive way to approach the challenge or problem statement in a different way. I have an amazing role of using Azure as my LEGO playpen and then building a custom solution (LEGO model) to help my customers.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/post/2019/csa-tools-of-the-trade/" class="d-block"><img data-src="/images/2019/toolbox_hu77618a475428863a0b189406d0eceb4f_58778_700x350_fill_q75_box_smart1.jpg" class="card-img-top mx-auto d-block" alt="Cloud Solutions Architect - Tools of the Trade"><div class="card-body">
            <h4 class="card-title">Cloud Solutions Architect - Tools of the Trade</h4>
            <p class="card-text text-muted text-uppercase">July 9, 2019</p>
            <div class="card-text">
                So a question I often get asked is “what tools or products do you use?”. So I decided to do a post around the tools and technologies that I personally use on a daily basis. So to start this is what people see on my screen on a daily basis.
This is my most common tool, Visual Studio Code, the version shown above is actually the Insiders Build. The primary reason for this tool is that is a “container” for other tools and functionality.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/post/2019/network-security-group-change-alerting/" class="d-block"><img data-src="/images/2021/azNSG_huea3d5727bdb1a296681a67bb8f082132_4295_700x350_fill_q75_box_smart1.jpg" class="card-img-top mx-auto d-block" alt="Network Security Group Change Alerting"><div class="card-body">
            <h4 class="card-title">Network Security Group Change Alerting</h4>
            <p class="card-text text-muted text-uppercase">February 20, 2019</p>
            <div class="card-text">
                So, I was with a customer and they are asking for a fairly standard alert.
“Please alert me when an NSG is added or modified”. Seems simply enough, however this is not as simply as you think. So I used my favourite search and found the following, “How to receive an email on Azure Network Security Group Rule changes“, this is great content and after testing, it works exactly as expected.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/post/history/2015-08-27-sla-reporting-with-powershell-and-scsm/" class="d-block"><div class="card-body">
            <h4 class="card-title">SLA Reporting with PowerShell and SCSM</h4>
            <p class="card-text text-muted text-uppercase">August 27, 2015</p>
            <div class="card-text">
                I always get asked about reporting from my customers, and specifically around SLA’s. SLA’s are very important to most companies as this is part of the tracking mechanism of employees and vendors and the like.
SMLETS is needed for this, it is built to be run from the server, if you need to run from your local machine, please install SMLets, copy the SDK Binaries folder and use the -computername where applicable with the SMLets commands.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/post/history/2014-04-04-adding-comments-to-work-items-with-orchestrator/" class="d-block"><div class="card-body">
            <h4 class="card-title">Adding Comments to Work Items with Orchestrator</h4>
            <p class="card-text text-muted text-uppercase">April 4, 2014</p>
            <div class="card-text">
                Hi All,
It has been a little while, i have been quite involved with an Integration Project. With this project there was a requirement to add comments to a Work Item. The information is passed on from “System A” to “System B” via XML. Using PowerShell, extracting the XML contents is not too difficult, if anyone would like to dive into that a little bit, please let me know with Comments.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/post/history/2013-11-15-send-email-to-3rd-party-from-scsm-console-powershell-and-console-task/" class="d-block"><div class="card-body">
            <h4 class="card-title">Send Email to 3rd Party from SCSM Console – PowerShell and Console Task</h4>
            <p class="card-text text-muted text-uppercase">November 15, 2013</p>
            <div class="card-text">
                So recently, I had a customer ask me for the following as their previous incident management system had this functionality.
The customer wanted to be able to send an “Update Email” to a 3rd party from the SCSM Console with automatically placing the reference number into said email. They needed the functionality of sending to any email address. This was a requirement for the type of business they are in.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2013/10/20/finding-off-site-ready-tapes-for-system-center-data-protection-manager-with-system-center-orchestrator/" class="d-block"><div class="card-body">
            <h4 class="card-title">Finding off site ready tapes for System Center Data Protection Manager with System Center Orchestrator</h4>
            <p class="card-text text-muted text-uppercase">October 20, 2013</p>
            <div class="card-text">
                So, I am quite a keen user of PowerShell and System Centre Orchestrator. Ok, so I recently had a request from a customer that went as follows “I need DPM to alert me when tapes are ready to be taken off-site.”
DPM does not seen to have this functionality out of the box within the Graphical User Interface (GUI). All is NOT lost, Data Protection Manager has a PowerShell component and i was sure i could figure out a way to get this to work within PowerShell.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2013/09/11/service-request-load-testing-for-scsm/" class="d-block"><div class="card-body">
            <h4 class="card-title">Service Request Load Testing for SCSM</h4>
            <p class="card-text text-muted text-uppercase">September 11, 2013</p>
            <div class="card-text">
                I have found a great for load testing SCSM with Incidents. The script uses SMLets to generate Incidents and you can then gauge how your system would handle the load you are planning within your Production Environment.
I will not go into the detail of the script as this blog post does a great job of explaining it. SO this got me to thinking about other Load Testing you could perform.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2012/12/20/assignedto-and-affecteduser-with-powershell-service-manager/" class="d-block"><div class="card-body">
            <h4 class="card-title">AssignedTo and AffectedUser with Powershell – Service Manager</h4>
            <p class="card-text text-muted text-uppercase">December 20, 2012</p>
            <div class="card-text">
                So recently I got an e-mail to my newly setup e-mail address, for just this reason , from someone asking if I knew a way to do the following.
 “I was trying to find a way to find all Incidents related to a specific person (assigned to or affected user) using PowerShell” So, I decided the best to answer this with a blog post as maybe there are other people out there asking the same question.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2012/06/07/basic-cluster-troubleshooting/" class="d-block"><div class="card-body">
            <h4 class="card-title">Basic Cluster Troubleshooting</h4>
            <p class="card-text text-muted text-uppercase">June 7, 2012</p>
            <div class="card-text">
                So, just last night, we had an issue with our cluster.One of our disks would not come online. We were seeing an error event ID: 1304 as below.
So, we began to investigate as all the Technet articles state that the drive is corrupted and Disk Signatures need to be changed, however we have had no major changes in the last little while. We were also able to view to CSV Volume from our SAN management tools.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2012/01/17/rebuilding-the-opsman-client-cache/" class="d-block"><div class="card-body">
            <h4 class="card-title">Rebuilding the OpsMan Client Cache</h4>
            <p class="card-text text-muted text-uppercase">January 17, 2012</p>
            <div class="card-text">
                Just recently I had the need to “rebuild” the client cache on a lot of my servers, due to a slight hiccup with our Network and subsequently our Operations Manager Server. So I decided to use PowerShell, if you need to repeat it, script it.
So, I simply built a script to connect to the required machine, stop the “Health Service”, delete the files from the required folder and then restart the “Health Service”.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/09/01/documenting-the-environment/" class="d-block"><div class="card-body">
            <h4 class="card-title">Documenting the Environment</h4>
            <p class="card-text text-muted text-uppercase">September 1, 2011</p>
            <div class="card-text">
                Hi All,
It has been a really busy time for me. However, I am very happy with life at the moment. Just recently I received a “Microsoft Community Contributor” award from Microsoft.

I know I have been a little quite the last little while. I have been busy doing a job that everyone loves (I wish there was a font for sarcasm). I have been VERY busy documenting my production environment including Hyper-V, Active Directory and Exchange.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/07/11/get-hotfix-on-steroids/" class="d-block"><div class="card-body">
            <h4 class="card-title">Get-hotfix on Steroids</h4>
            <p class="card-text text-muted text-uppercase">July 11, 2011</p>
            <div class="card-text">
                Hi All,
I have taken the get-hotfix and tweaked it so something useful for my environment.
I have uploaded the .ps1 file to Technet.
My script can be found here
Hope you find this helpful.
Follow me
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/07/07/building-more-redundancy-and-replicating-folder-structure/" class="d-block"><div class="card-body">
            <h4 class="card-title">Building more redundancy and replicating folder structure</h4>
            <p class="card-text text-muted text-uppercase">July 7, 2011</p>
            <div class="card-text">
                We have had a few failures of the power kind (thanks to the electricity provider in South Africa, who will remain nameless). So we have now had to build in further redundancy to cater for this and for other business needs. There is nothing worse than getting a phone call saying that critical services are unavailable at a CRITICAL time. What a nightmare. So a few plans were set in motion.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/05/27/changing-your-protection-server-in-dpm-to-another-server/" class="d-block"><div class="card-body">
            <h4 class="card-title">Changing your Protection Server in DPM to another server</h4>
            <p class="card-text text-muted text-uppercase">May 27, 2011</p>
            <div class="card-text">
                Have you ever been in a situation where you have either removed or added a new DPM server to your environment?
It happened to me just the other day, I had to “re-think” my DPM design and starting using “Local” to each Data Centre DPM servers to backup my data at each Data Centre. However, this was not the case before this, we were using the same product, but a different strategy.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/05/24/to-protect-or-not-to-protect/" class="d-block"><div class="card-body">
            <h4 class="card-title">To Protect or NOT to Protect</h4>
            <p class="card-text text-muted text-uppercase">May 24, 2011</p>
            <div class="card-text">
                I have finally found some time to look some more into DPM and decided to modify my environment and created some additional PROTECTION GROUPS. I am particularly chuffed as I have not done this before. Make no error, I have used DPM extensively for mailbox recoveries (Execs and other users crying about loosing items), recovering of databases and VHD (see some of my previous posts). So back to my point, the Protection groups were created without any hassle and now I have a dedicated SharePoint Protection Group.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/05/20/powershell-console-to-power-all-plugins/" class="d-block"><div class="card-body">
            <h4 class="card-title">POWERshell console to power all plugins</h4>
            <p class="card-text text-muted text-uppercase">May 20, 2011</p>
            <div class="card-text">
                I do not know about everyone else. I am a rather busy admin and quite fond of powershell and scripting. However, I also have a separate admin account for doing my administrative tasks. Now when you are working with multiple systems, all of which have PowerShell consoles, it can become a little bit of a pain opening a console for Exchange 2010, Operations Manager 2010, Virtual Machine Manager and Service Manager to name a few.
            </div>
        </div>
    </a>
</div>

            </div>
        
            <div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/05/17/using-smlets-practically/" class="d-block"><div class="card-body">
            <h4 class="card-title">Using SMLets practically</h4>
            <p class="card-text text-muted text-uppercase">May 17, 2011</p>
            <div class="card-text">
                In my previous post, SCSM And Powershell, I mentioned that I am now starting to play with get-scsmobject. In this post I also created a script. That script has now been evolved into a proper get-scsmobject script.$Now=(get-date).AddDays(-7)
$CId=(Get-SCSMEnumeration -ComputerName &#34;ms-ec-hdm01&#34;IncidentStatusEnum.Closed$).id
$RId=(Get-SCSMEnumeration -ComputerName &#34;ms-ec-hdm01&#34;IncidentStatusEnum.Resolved$).id
$Class=Get-SCSMClass -ComputerName &#34;ms-ec-hdm01&#34;System.WorkItem.Incident$$cType=&#34;Microsoft.EnterpriseManagement.Common.EnterpriseManagementObjectCriteria&#34;#$cString = “Status != ‘$CId’ and Status != ‘$RId’ and TargetResolutionTime &lt; ‘$Now’ and TargetResolutionTime Is Not Null”$cStringClosed=&#34;Status = ‘$CId’and CreatedDate &gt;&#39;$Now’&#34;$cStringResolved=&#34;Status = ‘$RId’and CreatedDate &gt;&#39;$Now’&#34;$cStringAll=&#34;CreatedDate &gt;&#39;$Now&#39;&#34;$critClosed=new-object $cType$cStringClosed,$Class$critResolved=new-object $cType$cStringResolved,$Class$critAll=new-object $cType$cStringOther,$Class$closed=Get-SCSMObject -ComputerName &#34;ms-ec-hdm01&#34;-Criteria $critClosed$resolved=Get-SCSMObject -ComputerName &#34;ms-ec-hdm01&#34;-Criteria $critResolved$all=Get-SCSMObject -ComputerName &#34;ms-ec-hdm01&#34;-Criteria $critAll#$all = Get-SCSMObject -ComputerName “ms-ec-hdm01” -Class (Get-SCSMClass -ComputerName “ms-ec-hdm01” System.
            </div>
        </div>
    </a>
</div>

            </div>
        
    </div>
</main>


    <footer class="footer text-center bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://cloudadventures.fskelly.com/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                            <a href="https://github.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://linkedin.com/in/fletcherkelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://twitter.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-muted">
                    
                        Copyright © 2019–2021, Fletcher Kelly; all rights reserved.
                    
                </p>

                <p class="text-muted">
                Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with <a href="https://github.com/puresyntax71/hugo-theme-chunky-poster" target="_blank">Chunky Poster</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    
    
        
            <script src="/dist/main.d608eadfe5ac0688902e.min.js"></script>
        
    



<script>
    window.Prism = window.Prism || {};
    window.Prism.manual = true;
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>







    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-XXXX', 'auto');
	
	ga('send', 'pageview');
}
</script>
</body>
</html>
