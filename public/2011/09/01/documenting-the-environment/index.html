<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>
  
     Documenting the Environment | 
    Fletcher&#39;s Tech Blog
  
</title><meta name="description" content="A day in the life of a Cloud Engineer."><meta name="author" content="Fletcher Kelly">

<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png " sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0c344b">
<link rel="icon" href="/favicon.ico">


    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism.min.css">
    



    
        
            <link rel="stylesheet" href="/dist/main.37ab3f61b95417873748.min.css">
        
    




<link rel="canonical" href="https://cloudadventures.fskelly.com/2011/09/01/documenting-the-environment/"><meta property="og:title" content="Documenting the Environment" />
<meta property="og:description" content="Hi All,
It has been a really busy time for me. However, I am very happy with life at the moment. Just recently I received a “Microsoft Community Contributor” award from Microsoft.

I know I have been a little quite the last little while. I have been busy doing a job that everyone loves (I wish there was a font for sarcasm). I have been VERY busy documenting my production environment including Hyper-V, Active Directory and Exchange." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloudadventures.fskelly.com/2011/09/01/documenting-the-environment/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2011-09-01T07:16:09+00:00" />
<meta property="article:modified_time" content="2011-09-01T07:16:09+00:00" />

<meta itemprop="name" content="Documenting the Environment">
<meta itemprop="description" content="Hi All,
It has been a really busy time for me. However, I am very happy with life at the moment. Just recently I received a “Microsoft Community Contributor” award from Microsoft.

I know I have been a little quite the last little while. I have been busy doing a job that everyone loves (I wish there was a font for sarcasm). I have been VERY busy documenting my production environment including Hyper-V, Active Directory and Exchange."><meta itemprop="datePublished" content="2011-09-01T07:16:09+00:00" />
<meta itemprop="dateModified" content="2011-09-01T07:16:09+00:00" />
<meta itemprop="wordCount" content="232">
<meta itemprop="keywords" content="Active Directory,Exchange,GPO,Group Policy,MCC,powershell,Receive Connector,Virtual Machine Manager,VMM," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Documenting the Environment"/>
<meta name="twitter:description" content="Hi All,
It has been a really busy time for me. However, I am very happy with life at the moment. Just recently I received a “Microsoft Community Contributor” award from Microsoft.

I know I have been a little quite the last little while. I have been busy doing a job that everyone loves (I wish there was a font for sarcasm). I have been VERY busy documenting my production environment including Hyper-V, Active Directory and Exchange."/>

</head>
<body>
    
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://cloudadventures.fskelly.com">Fletcher&#39;s Tech Blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
            
            </ul>
        </div>
    </div>
</nav>


    
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="meta text-muted mb-3">
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">September 1, 2011</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>232 words</span>
                            <span><i class="fas fa-clock mr-2"></i>2 mins read</span>
                        </div>

                        <h1>Documenting the Environment</h1>

                        
                    </div>
                </div><div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="content">
                            <p> </p>
<p>Hi All,</p>
<p>It has been a really busy time for me. However, I am very happy with life at the moment. Just recently I received a “Microsoft Community Contributor” award from Microsoft.</p>
<p><a href="http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color.jpg"><!-- raw HTML omitted --></a></p>
<p>I know I have been a little quite the last little while. I have been busy doing a job that everyone loves (I wish there was a font for sarcasm). I have been VERY busy documenting my production environment including Hyper-V, Active Directory and Exchange. This is a long and tiresome process, however PowerShell has been a phenomenal help and I thought I would share a few bits of code from PowerShell that have made my life a little easier in this process.</p>
<p><strong>ACTIVE DIRECTORY</strong></p>
<p>A script to list all GPO in required Domain</p>
<blockquote>
<p>Import-Module grouppolicy<br>
#command to get all GPOS<br>
get-gpo -all -Domain domainname</p>
</blockquote>
<!-- raw HTML omitted -->
<blockquote>
<p>Import-Module grouppolicy<br>
#command to backup all GPOS<br>
Backup-GPO -All -Domain domainname -Path filepath</p>
</blockquote>
<p><strong>EXCHANGE</strong> </p>
<p>A script to pull the IP address listed within a Receive Connector</p>
<blockquote>
<p>Add-PSSnapin Microsoft.Exchange.Management.PowerShell.E2010<br>
Add-PSSnapin Microsoft.Exchange.Management.PowerShell.Support<br>
Get-ReceiveConnector -Server <!-- raw HTML omitted --><br>
Get-ReceiveConnector -Identity &ldquo;<!-- raw HTML omitted -->&rdquo; | Select-Object -ExpandProperty RemoteIPRanges</p>
</blockquote>
<p><strong>VIRTUAL MACHINE MANAGER</strong></p>
<p>A script to pull the VMs being controlled by Virtual Machine manager and sort them by Host Name for easier documentation.</p>
<blockquote>
<p>Add-PSSnapin Microsoft.SystemCenter.VirtualMachineManager<br>
Get-VMMServer nameofvmmserver<br>
Get-VM -VMMServer nameofvmmserver | Select-Object -Property Name, Owner, Description, HostName, OperatingSystem, CPUCount, Memory | Sort-Object -Property HostName</p>
</blockquote>
<p>Really hope this helps some other people as well.</p>
<p>Follow me</p>
<p><a href="http://www.facebook.com/fletcher.kelly"><!-- raw HTML omitted --></a> <a href="http://twitter.com/#!/fskelly"><!-- raw HTML omitted --></a></p>
<p><a href="http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color1.jpg"><!-- raw HTML omitted --></a></p>

                        </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/active-directory">
                                    <i class="fas fa-tag mr-2"></i>Active Directory
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/exchange">
                                    <i class="fas fa-tag mr-2"></i>Exchange
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/gpo">
                                    <i class="fas fa-tag mr-2"></i>GPO
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/group-policy">
                                    <i class="fas fa-tag mr-2"></i>Group Policy
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/mcc">
                                    <i class="fas fa-tag mr-2"></i>MCC
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/powershell">
                                    <i class="fas fa-tag mr-2"></i>powershell
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/receive-connector">
                                    <i class="fas fa-tag mr-2"></i>Receive Connector
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/virtual-machine-manager">
                                    <i class="fas fa-tag mr-2"></i>Virtual Machine Manager
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/vmm">
                                    <i class="fas fa-tag mr-2"></i>VMM
                                </a></div><ul class="share nav my-3 justify-content-end">
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://twitter.com/intent/tweet?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2011%2f09%2f01%2fdocumenting-the-environment%2f&text=Documenting%20the%20Environment">
              <i class="fa-fw fab fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2011%2f09%2f01%2fdocumenting-the-environment%2f&title=Documenting%20the%20Environment">
                <i class="fa-fw fab fa-linkedin-in"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fcloudadventures.fskelly.com%2f2011%2f09%2f01%2fdocumenting-the-environment%2f&t=Documenting%20the%20Environment">
                <i class="fa-fw fab fa-facebook-f"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://reddit.com/submit?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2011%2f09%2f01%2fdocumenting-the-environment%2f&title=Documenting%20the%20Environment">
                <i class="fa-fw fab fa-reddit-alien"></i>
            </a>
        </li>
    </nav>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        
                    </div>
                </div><div class="row justify-content-center my-3">
                    <div class="col-lg-8">
                        <div id="commento"></div>
                        <script src="https://commento.io"></script>
                    </div>
                </div></article>
        </div>
    </div>

    <div class="related-content row mt-5 row-cols-1 row-cols-lg-3"><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/07/11/get-hotfix-on-steroids/" class="d-block"><div class="card-body">
            <h4 class="card-title">Get-hotfix on Steroids</h4>
            <p class="card-text text-muted text-uppercase">July 11, 2011</p>
            <div class="card-text">
                Hi All,
I have taken the get-hotfix and tweaked it so something useful for my environment.
I have uploaded the .ps1 file to Technet.
My script can be found here
Hope you find this helpful.
Follow me
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/07/07/building-more-redundancy-and-replicating-folder-structure/" class="d-block"><div class="card-body">
            <h4 class="card-title">Building more redundancy and replicating folder structure</h4>
            <p class="card-text text-muted text-uppercase">July 7, 2011</p>
            <div class="card-text">
                We have had a few failures of the power kind (thanks to the electricity provider in South Africa, who will remain nameless). So we have now had to build in further redundancy to cater for this and for other business needs. There is nothing worse than getting a phone call saying that critical services are unavailable at a CRITICAL time. What a nightmare. So a few plans were set in motion.
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/05/27/changing-your-protection-server-in-dpm-to-another-server/" class="d-block"><div class="card-body">
            <h4 class="card-title">Changing your Protection Server in DPM to another server</h4>
            <p class="card-text text-muted text-uppercase">May 27, 2011</p>
            <div class="card-text">
                Have you ever been in a situation where you have either removed or added a new DPM server to your environment?
It happened to me just the other day, I had to “re-think” my DPM design and starting using “Local” to each Data Centre DPM servers to backup my data at each Data Centre. However, this was not the case before this, we were using the same product, but a different strategy.
            </div>
        </div>
    </a>
</div>

            </div></div>
</main>


    <footer class="footer text-center bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://cloudadventures.fskelly.com/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                            <a href="https://github.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://linkedin.com/in/fletcherkelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://twitter.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-muted">
                    
                        Copyright © 2013–2021, Fletcher Kelly; all rights reserved.
                    
                </p>

                <p class="text-muted">
                Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with <a href="https://github.com/puresyntax71/hugo-theme-chunky-poster" target="_blank">Chunky Poster</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    
    
        
            <script src="/dist/main.d608eadfe5ac0688902e.min.js"></script>
        
    



<script>
    window.Prism = window.Prism || {};
    window.Prism.manual = true;
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>







    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-XXXX', 'auto');
	
	ga('send', 'pageview');
}
</script>
</body>
</html>
