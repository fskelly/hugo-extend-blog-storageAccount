<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>
  
     POWERshell console to power all plugins | 
    Fletcher&#39;s Tech Blog
  
</title><meta name="description" content="A day in the life of a Cloud Engineer."><meta name="author" content="Fletcher Kelly">

<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png " sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0c344b">
<link rel="icon" href="/favicon.ico">


    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism.min.css">
    



    
        
            <link rel="stylesheet" href="/dist/main.37ab3f61b95417873748.min.css">
        
    




<link rel="canonical" href="https://cloudadventures.fskelly.com/2011/05/20/powershell-console-to-power-all-plugins/"><meta property="og:title" content="POWERshell console to power all plugins" />
<meta property="og:description" content="I do not know about everyone else. I am a rather busy admin and quite fond of powershell and scripting. However, I also have a separate admin account for doing my administrative tasks. Now when you are working with multiple systems, all of which have PowerShell consoles, it can become a little bit of a pain opening a console for Exchange 2010, Operations Manager 2010, Virtual Machine Manager and Service Manager to name a few." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloudadventures.fskelly.com/2011/05/20/powershell-console-to-power-all-plugins/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2011-05-20T11:07:09+00:00" />
<meta property="article:modified_time" content="2011-05-20T11:07:09+00:00" />

<meta itemprop="name" content="POWERshell console to power all plugins">
<meta itemprop="description" content="I do not know about everyone else. I am a rather busy admin and quite fond of powershell and scripting. However, I also have a separate admin account for doing my administrative tasks. Now when you are working with multiple systems, all of which have PowerShell consoles, it can become a little bit of a pain opening a console for Exchange 2010, Operations Manager 2010, Virtual Machine Manager and Service Manager to name a few."><meta itemprop="datePublished" content="2011-05-20T11:07:09+00:00" />
<meta itemprop="dateModified" content="2011-05-20T11:07:09+00:00" />
<meta itemprop="wordCount" content="284">
<meta itemprop="keywords" content="Elevation,Module,powershell,PSSnapin," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="POWERshell console to power all plugins"/>
<meta name="twitter:description" content="I do not know about everyone else. I am a rather busy admin and quite fond of powershell and scripting. However, I also have a separate admin account for doing my administrative tasks. Now when you are working with multiple systems, all of which have PowerShell consoles, it can become a little bit of a pain opening a console for Exchange 2010, Operations Manager 2010, Virtual Machine Manager and Service Manager to name a few."/>

</head>
<body>
    
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://cloudadventures.fskelly.com">Fletcher&#39;s Tech Blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
            
            </ul>
        </div>
    </div>
</nav>


    
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="meta text-muted mb-3">
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">May 20, 2011</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>284 words</span>
                            <span><i class="fas fa-clock mr-2"></i>2 mins read</span>
                        </div>

                        <h1>POWERshell console to power all plugins</h1>

                        
                    </div>
                </div><div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="content">
                            <p>I do not know about everyone else. I am a rather busy admin and quite fond of powershell and scripting. However, I also have a separate admin account for doing my administrative tasks. Now when you are working with multiple systems, all of which have PowerShell consoles, it can become a little bit of a pain opening a console for Exchange 2010, Operations Manager 2010, Virtual Machine Manager and Service Manager to name a few. There are tons of products that now have powershell interfaces. Would it not be great to have ONE SHELL to control them all, with all the PSSnapins and Modules? The answer is of course, YES. This is what I got right thanks to Uncle GOOGLE and a lot a research and a wonderful thing called the <a href="http://technet.microsoft.com/en-us/library/ee692764.aspx">Powershell Profile</a>. So using another <a href="http://www.wooditwork.com/2010/08/11/pimping-your-powershell-profile/">link</a> I found as a base, I started my mission. I though of all the modules and pssnapins I used and created the shell below.</p>
<p><a href="http://fskelly.files.wordpress.com/2011/05/image.png"><!-- raw HTML omitted --></a></p>
<p>It adds all the Modules and PSSnapins I use on a daily basis, I also copied the same profile.ps1 to my “admin” profile so that the same would happen when using this as my “admin” account. See code snippet below. The first line of code caters for those people like me using PowerGui and the Script-Explorer addon, that took some time for figure out, hope you enjoy<!-- raw HTML omitted --> (2 different views included to make it easier to use if you so wish)</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p> </p>
<p>Talking about “admin” accounts, the one BIG thing about Windows 7 is the lack of “Running as another account and elevated”. I also found a <a href="http://www.techrepublic.com/blog/window-on-windows/elevate-privileges-automatically-with-elevation-powertoys/1425">solution</a> to this as well.</p>
<p>I really hope this helps everyone, like this has helped me.</p>
<p> </p>
<p>Follow me</p>
<p><a href="http://www.facebook.com/fletcher.kelly"><!-- raw HTML omitted --></a> <a href="http://twitter.com/#!/fskelly"><!-- raw HTML omitted --></a> <a href="http://fskelly.wordpress.com/"><!-- raw HTML omitted --></a></p>

                        </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/elevation">
                                    <i class="fas fa-tag mr-2"></i>Elevation
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/module">
                                    <i class="fas fa-tag mr-2"></i>Module
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/powershell">
                                    <i class="fas fa-tag mr-2"></i>powershell
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/pssnapin">
                                    <i class="fas fa-tag mr-2"></i>PSSnapin
                                </a></div><ul class="share nav my-3 justify-content-end">
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://twitter.com/intent/tweet?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2011%2f05%2f20%2fpowershell-console-to-power-all-plugins%2f&text=POWERshell%20console%20to%20power%20all%20plugins">
              <i class="fa-fw fab fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2011%2f05%2f20%2fpowershell-console-to-power-all-plugins%2f&title=POWERshell%20console%20to%20power%20all%20plugins">
                <i class="fa-fw fab fa-linkedin-in"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fcloudadventures.fskelly.com%2f2011%2f05%2f20%2fpowershell-console-to-power-all-plugins%2f&t=POWERshell%20console%20to%20power%20all%20plugins">
                <i class="fa-fw fab fa-facebook-f"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://reddit.com/submit?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2011%2f05%2f20%2fpowershell-console-to-power-all-plugins%2f&title=POWERshell%20console%20to%20power%20all%20plugins">
                <i class="fa-fw fab fa-reddit-alien"></i>
            </a>
        </li>
    </nav>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        
                    </div>
                </div><div class="row justify-content-center my-3">
                    <div class="col-lg-8">
                        <div id="commento"></div>
                        <script src="https://commento.io"></script>
                    </div>
                </div></article>
        </div>
    </div>

    <div class="related-content row mt-5 row-cols-1 row-cols-lg-3"><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/05/17/using-smlets-practically/" class="d-block"><div class="card-body">
            <h4 class="card-title">Using SMLets practically</h4>
            <p class="card-text text-muted text-uppercase">May 17, 2011</p>
            <div class="card-text">
                In my previous post, SCSM And Powershell, I mentioned that I am now starting to play with get-scsmobject. In this post I also created a script. That script has now been evolved into a proper get-scsmobject script.$Now=(get-date).AddDays(-7)
$CId=(Get-SCSMEnumeration -ComputerName &#34;ms-ec-hdm01&#34;IncidentStatusEnum.Closed$).id
$RId=(Get-SCSMEnumeration -ComputerName &#34;ms-ec-hdm01&#34;IncidentStatusEnum.Resolved$).id
$Class=Get-SCSMClass -ComputerName &#34;ms-ec-hdm01&#34;System.WorkItem.Incident$$cType=&#34;Microsoft.EnterpriseManagement.Common.EnterpriseManagementObjectCriteria&#34;#$cString = “Status != ‘$CId’ and Status != ‘$RId’ and TargetResolutionTime &lt; ‘$Now’ and TargetResolutionTime Is Not Null”$cStringClosed=&#34;Status = ‘$CId’and CreatedDate &gt;&#39;$Now’&#34;$cStringResolved=&#34;Status = ‘$RId’and CreatedDate &gt;&#39;$Now’&#34;$cStringAll=&#34;CreatedDate &gt;&#39;$Now&#39;&#34;$critClosed=new-object $cType$cStringClosed,$Class$critResolved=new-object $cType$cStringResolved,$Class$critAll=new-object $cType$cStringOther,$Class$closed=Get-SCSMObject -ComputerName &#34;ms-ec-hdm01&#34;-Criteria $critClosed$resolved=Get-SCSMObject -ComputerName &#34;ms-ec-hdm01&#34;-Criteria $critResolved$all=Get-SCSMObject -ComputerName &#34;ms-ec-hdm01&#34;-Criteria $critAll#$all = Get-SCSMObject -ComputerName “ms-ec-hdm01” -Class (Get-SCSMClass -ComputerName “ms-ec-hdm01” System.
            </div>
        </div>
    </a>
</div>

            </div></div>
</main>


    <footer class="footer text-center bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://cloudadventures.fskelly.com/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                            <a href="https://github.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://linkedin.com/in/fletcherkelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://twitter.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-muted">
                    
                        Copyright © 2013–2021, Fletcher Kelly; all rights reserved.
                    
                </p>

                <p class="text-muted">
                Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with <a href="https://github.com/puresyntax71/hugo-theme-chunky-poster" target="_blank">Chunky Poster</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    
    
        
            <script src="/dist/main.d608eadfe5ac0688902e.min.js"></script>
        
    



<script>
    window.Prism = window.Prism || {};
    window.Prism.manual = true;
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>







    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-XXXX', 'auto');
	
	ga('send', 'pageview');
}
</script>
</body>
</html>
