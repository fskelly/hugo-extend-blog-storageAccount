<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>
  
     Finding off site ready tapes for System Center Data Protection Manager with System Center Orchestrator | 
    Fletcher&#39;s Tech Blog
  
</title><meta name="description" content="A day in the life of a Cloud Engineer."><meta name="author" content="Fletcher Kelly">

<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png " sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0c344b">
<link rel="icon" href="/favicon.ico">


    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism.min.css">
    



    
        
            <link rel="stylesheet" href="/dist/main.37ab3f61b95417873748.min.css">
        
    




<link rel="canonical" href="https://cloudadventures.fskelly.com/2013/10/20/finding-off-site-ready-tapes-for-system-center-data-protection-manager-with-system-center-orchestrator/"><meta property="og:title" content="Finding off site ready tapes for System Center Data Protection Manager with System Center Orchestrator" />
<meta property="og:description" content="So, I am quite a keen user of PowerShell and System Centre Orchestrator. Ok, so I recently had a request from a customer that went as follows “I need DPM to alert me when tapes are ready to be taken off-site.”
DPM does not seen to have this functionality out of the box within the Graphical User Interface (GUI). All is NOT lost, Data Protection Manager has a PowerShell component and i was sure i could figure out a way to get this to work within PowerShell." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloudadventures.fskelly.com/2013/10/20/finding-off-site-ready-tapes-for-system-center-data-protection-manager-with-system-center-orchestrator/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2013-10-20T12:30:19+00:00" />
<meta property="article:modified_time" content="2013-10-20T12:30:19+00:00" />

<meta itemprop="name" content="Finding off site ready tapes for System Center Data Protection Manager with System Center Orchestrator">
<meta itemprop="description" content="So, I am quite a keen user of PowerShell and System Centre Orchestrator. Ok, so I recently had a request from a customer that went as follows “I need DPM to alert me when tapes are ready to be taken off-site.”
DPM does not seen to have this functionality out of the box within the Graphical User Interface (GUI). All is NOT lost, Data Protection Manager has a PowerShell component and i was sure i could figure out a way to get this to work within PowerShell."><meta itemprop="datePublished" content="2013-10-20T12:30:19+00:00" />
<meta itemprop="dateModified" content="2013-10-20T12:30:19+00:00" />
<meta itemprop="wordCount" content="422">
<meta itemprop="keywords" content="DPM,powershell,SCORCH,script," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Finding off site ready tapes for System Center Data Protection Manager with System Center Orchestrator"/>
<meta name="twitter:description" content="So, I am quite a keen user of PowerShell and System Centre Orchestrator. Ok, so I recently had a request from a customer that went as follows “I need DPM to alert me when tapes are ready to be taken off-site.”
DPM does not seen to have this functionality out of the box within the Graphical User Interface (GUI). All is NOT lost, Data Protection Manager has a PowerShell component and i was sure i could figure out a way to get this to work within PowerShell."/>

</head>
<body>
    
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://cloudadventures.fskelly.com">Fletcher&#39;s Tech Blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                
            
            </ul>
        </div>
    </div>
</nav>


    
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="meta text-muted mb-3">
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">October 20, 2013</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>422 words</span>
                            <span><i class="fas fa-clock mr-2"></i>2 mins read</span>
                        </div>

                        <h1>Finding off site ready tapes for System Center Data Protection Manager with System Center Orchestrator</h1>

                        
                    </div>
                </div><div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="content">
                            <p>So, I am quite a keen user of <a href="http://technet.microsoft.com/en-us/library/bb978526.aspx">PowerShell</a> and <a href="http://www.google.co.za/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;frm=1&amp;source=web&amp;cd=1&amp;cad=rja&amp;ved=0CDUQFjAA&amp;url=http%3A%2F%2Ftechnet.microsoft.com%2Fen-us%2Flibrary%2Fhh237242.aspx&amp;ei=PMNjUuzfJoqPtQb0uICYAg&amp;usg=AFQjCNHe_k_azRZpbqkjWNihkTAi7Sa8TA&amp;sig2=gtvsjQw1WlO-1_z9DOaoWw">System Centre Orchestrator</a>. Ok, so I recently had a request from a customer that went as follows “I need <a href="http://www.google.co.za/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;frm=1&amp;source=web&amp;cd=1&amp;cad=rja&amp;ved=0CCoQFjAA&amp;url=http%3A%2F%2Ftechnet.microsoft.com%2Fen-us%2Flibrary%2Fhh758173.aspx&amp;ei=p8NjUsHrM-Gk0QWr5IDoDA&amp;usg=AFQjCNHp7-kW7roL5xjnRh8RaTTo47J6DQ&amp;sig2=79y8wIROrx6zRLRap0fgIQ">DPM</a> to alert me when tapes are ready to  be taken off-site.”</p>
<p>DPM does not seen to have this functionality out of the box within the Graphical User Interface (GUI). All is NOT lost, <a href="http://www.google.co.za/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;frm=1&amp;source=web&amp;cd=1&amp;cad=rja&amp;ved=0CCoQFjAA&amp;url=http%3A%2F%2Ftechnet.microsoft.com%2Fen-us%2Flibrary%2Fhh758173.aspx&amp;ei=p8NjUsHrM-Gk0QWr5IDoDA&amp;usg=AFQjCNHp7-kW7roL5xjnRh8RaTTo47J6DQ&amp;sig2=79y8wIROrx6zRLRap0fgIQ">Data Protection Manager</a> has a PowerShell component and i was sure i could figure out a way to get this to work within PowerShell. Sure enough a solution in the form of PowerShell was <a href="http://risualblogs.com/blog/2010/04/09/dpm-powershell-script-to-show-offsite-ready-tapes/">found</a>, so using this as a base, I modified the PowerShell script to suit my needs. It was also slightly modified to use with <a href="http://www.google.co.za/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;frm=1&amp;source=web&amp;cd=1&amp;cad=rja&amp;ved=0CDUQFjAA&amp;url=http%3A%2F%2Ftechnet.microsoft.com%2Fen-us%2Flibrary%2Fhh237242.aspx&amp;ei=PMNjUuzfJoqPtQb0uICYAg&amp;usg=AFQjCNHe_k_azRZpbqkjWNihkTAi7Sa8TA&amp;sig2=gtvsjQw1WlO-1_z9DOaoWw">System Centre Orchestrator</a>. The custoemr also wanted some colour and wanted the result formatted in HTML. primarily for reading purposes and auditing purposes. PowerShell code below and link <a href="http://gallery.technet.microsoft.com/Which-tapes-are-ready-for-79f7e194">here</a>.</p>
<p>[code language=”powershell”]Import-Module DataProtectionManager<br>
$date = Get-Date -Format &ldquo;M-d-yyyy&rdquo;<br>
$path = &ldquo;c:\DPMOffisteTapes&quot;<br>
$filepath = $path + $date + &ldquo;.html&rdquo;<br>
#creates the folder if it does not exist<br>
New-Item -itemType file -Path $filepath<br>
$AllLibraries = get-dpmlibrary<br>
$AllTapes = Get-Tape -DPMLibrary $AllLibraries<br>
$offistereadytape = $AllTapes | Where-Object {$_.isoffsiteready -eq $true}<br>
$a = &ldquo;<!-- raw HTML omitted -->&rdquo;<br>
$a = $a + &ldquo;BODY{background-color:Green;}&rdquo;<br>
$a = $a + &ldquo;TABLE{border-width: 1px;border-style: solid;border-color: black;border-collapse: collapse;}&rdquo;<br>
$a = $a + &ldquo;TH{border-width: 1px;padding: 0px;border-style: solid;border-color: black;background-color:GreenYellow}&rdquo;<br>
$a = $a + &ldquo;TD{border-width: 1px;padding: 0px;border-style: solid;border-color: black;background-color:palegoldenrod}&rdquo;<br>
$a = $a + &ldquo;<!-- raw HTML omitted -->&rdquo;<br>
$offistereadytape | Select-object location, barcode , isoffsiteready|ConvertTo-Html -Head $a -Body &ldquo;<!-- raw HTML omitted -->Offsite Ready Tapes<!-- raw HTML omitted -->&rdquo; | out-file -FilePath $filepath[/code]</p>
<p>OK, so now we have the data in decent format.</p>
<p><a href="/wp-content/uploads/2013/10/image-1.png"><!-- raw HTML omitted --></a></p>
<p>So, with the more tapes that are ready, the more rows of data will be within the HTML.</p>
<p>Ok, so now we need to schedule the task. I know i could have used Task Scheduler and the like, however we have <a href="http://www.google.co.za/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;frm=1&amp;source=web&amp;cd=1&amp;cad=rja&amp;ved=0CDUQFjAA&amp;url=http%3A%2F%2Ftechnet.microsoft.com%2Fen-us%2Flibrary%2Fhh237242.aspx&amp;ei=PMNjUuzfJoqPtQb0uICYAg&amp;usg=AFQjCNHe_k_azRZpbqkjWNihkTAi7Sa8TA&amp;sig2=gtvsjQw1WlO-1_z9DOaoWw">System Centre Orchestrator</a> and with <a href="http://blogs.technet.com/b/privatecloud/archive/2013/08/09/automation-an-introduction-to-service-management-automation.aspx">Service Management Automation</a> available, more and more tasks will be automated. With this example, i decided to use Orchestrator.</p>
<p>So, I simply use a Monitor/Date Time to run the required activity at set intervals</p>
<p><a href="/wp-content/uploads/2013/10/image1.png"><!-- raw HTML omitted --></a></p>
<p>I then run a DPM Script from the <a href="http://technet.microsoft.com/en-us/library/hh830726.aspx">Data Protection Manager Integration Pack</a>.</p>
<p><a href="/wp-content/uploads/2013/10/image2.png"><!-- raw HTML omitted --></a></p>
<p><a href="/wp-content/uploads/2013/10/image3-1.png"><!-- raw HTML omitted --></a></p>
<p>The filepath Variable is where the html (the full path to the html file) is written, this is especially helpful when sending the Email Message. (I know this can be done with send-mailmessage directly within the PowerShell code)</p>
<p><a href="/wp-content/uploads/2013/10/image4-1.png"><!-- raw HTML omitted --></a></p>
<p>So there you have it, Some Orchestrator Magic with PowerShell and DPM.</p>
<p><a href="mailto:systemcenterguyza@live.com">(E-Mail me)</a></p>
<p><img src="/wp-content/uploads/2013/02/image_thumb_thumb_thumb_thumb_thumb1-1.png?w=497" alt=""></p>
<p>Follow me.</p>
<p><img src="http://fskelly.files.wordpress.com/2012/06/facebook-small322252222.jpg?w=44&amp;h=44" alt=""> Facebook (Personal)</p>
<p><img src="http://fskelly.files.wordpress.com/2012/06/twitter-small322252222.jpg?w=44&amp;h=44" alt=""> Twitter (Personal &amp; System Centre)</p>
<p><img src="/wp-content/uploads/2013/02/scsmlogo25232.jpg?w=56&amp;h=43" alt=""> Twitter (System Centre Focused)</p>

                        </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/dpm">
                                    <i class="fas fa-tag mr-2"></i>DPM
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/powershell">
                                    <i class="fas fa-tag mr-2"></i>powershell
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/scorch">
                                    <i class="fas fa-tag mr-2"></i>SCORCH
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/script">
                                    <i class="fas fa-tag mr-2"></i>script
                                </a></div><ul class="share nav my-3 justify-content-end">
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://twitter.com/intent/tweet?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2013%2f10%2f20%2ffinding-off-site-ready-tapes-for-system-center-data-protection-manager-with-system-center-orchestrator%2f&text=Finding%20off%20site%20ready%20tapes%20for%20System%20Center%20Data%20Protection%20Manager%20with%20System%20Center%20Orchestrator">
              <i class="fa-fw fab fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2013%2f10%2f20%2ffinding-off-site-ready-tapes-for-system-center-data-protection-manager-with-system-center-orchestrator%2f&title=Finding%20off%20site%20ready%20tapes%20for%20System%20Center%20Data%20Protection%20Manager%20with%20System%20Center%20Orchestrator">
                <i class="fa-fw fab fa-linkedin-in"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fcloudadventures.fskelly.com%2f2013%2f10%2f20%2ffinding-off-site-ready-tapes-for-system-center-data-protection-manager-with-system-center-orchestrator%2f&t=Finding%20off%20site%20ready%20tapes%20for%20System%20Center%20Data%20Protection%20Manager%20with%20System%20Center%20Orchestrator">
                <i class="fa-fw fab fa-facebook-f"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://reddit.com/submit?url=https%3a%2f%2fcloudadventures.fskelly.com%2f2013%2f10%2f20%2ffinding-off-site-ready-tapes-for-system-center-data-protection-manager-with-system-center-orchestrator%2f&title=Finding%20off%20site%20ready%20tapes%20for%20System%20Center%20Data%20Protection%20Manager%20with%20System%20Center%20Orchestrator">
                <i class="fa-fw fab fa-reddit-alien"></i>
            </a>
        </li>
    </nav>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        
                    </div>
                </div><div class="row justify-content-center my-3">
                    <div class="col-lg-8">
                        <div id="commento"></div>
                        <script src="https://commento.io"></script>
                    </div>
                </div></article>
        </div>
    </div>

    <div class="related-content row mt-5 row-cols-1 row-cols-lg-3"><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2013/09/11/service-request-load-testing-for-scsm/" class="d-block"><div class="card-body">
            <h4 class="card-title">Service Request Load Testing for SCSM</h4>
            <p class="card-text text-muted text-uppercase">September 11, 2013</p>
            <div class="card-text">
                I have found a great for load testing SCSM with Incidents. The script uses SMLets to generate Incidents and you can then gauge how your system would handle the load you are planning within your Production Environment.
I will not go into the detail of the script as this blog post does a great job of explaining it. SO this got me to thinking about other Load Testing you could perform.
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/07/11/get-hotfix-on-steroids/" class="d-block"><div class="card-body">
            <h4 class="card-title">Get-hotfix on Steroids</h4>
            <p class="card-text text-muted text-uppercase">July 11, 2011</p>
            <div class="card-text">
                Hi All,
I have taken the get-hotfix and tweaked it so something useful for my environment.
I have uploaded the .ps1 file to Technet.
My script can be found here
Hope you find this helpful.
Follow me
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/2011/05/27/changing-your-protection-server-in-dpm-to-another-server/" class="d-block"><div class="card-body">
            <h4 class="card-title">Changing your Protection Server in DPM to another server</h4>
            <p class="card-text text-muted text-uppercase">May 27, 2011</p>
            <div class="card-text">
                Have you ever been in a situation where you have either removed or added a new DPM server to your environment?
It happened to me just the other day, I had to “re-think” my DPM design and starting using “Local” to each Data Centre DPM servers to backup my data at each Data Centre. However, this was not the case before this, we were using the same product, but a different strategy.
            </div>
        </div>
    </a>
</div>

            </div></div>
</main>


    <footer class="footer text-center bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://cloudadventures.fskelly.com/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                            <a href="https://github.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://linkedin.com/in/fletcherkelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://twitter.com/fskelly" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-muted">
                    
                        Copyright © 2013–2021, Fletcher Kelly; all rights reserved.
                    
                </p>

                <p class="text-muted">
                Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with <a href="https://github.com/puresyntax71/hugo-theme-chunky-poster" target="_blank">Chunky Poster</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    
    
        
            <script src="/dist/main.d608eadfe5ac0688902e.min.js"></script>
        
    



<script>
    window.Prism = window.Prism || {};
    window.Prism.manual = true;
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>







    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-XXXX', 'auto');
	
	ga('send', 'pageview');
}
</script>
</body>
</html>
