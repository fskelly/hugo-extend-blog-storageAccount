---
title: Documenting the Environment
author: fskelly
type: post
date: 2011-09-01T07:16:09+00:00
url: /2011/09/01/documenting-the-environment/
tagazine-media:
  - 'a:7:{s:7:"primary";s:0:"";s:6:"images";a:6:{s:79:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color.jpg";a:6:{s:8:"file_url";s:79:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color.jpg";s:5:"width";s:3:"346";s:6:"height";s:3:"141";s:4:"type";s:5:"image";s:4:"area";s:5:"48786";s:9:"file_path";s:0:"";}s:85:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb.jpg";a:6:{s:8:"file_url";s:85:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb.jpg";s:5:"width";s:3:"244";s:6:"height";s:3:"102";s:4:"type";s:5:"image";s:4:"area";s:5:"24888";s:9:"file_path";s:0:"";}s:65:"http://fskelly.files.wordpress.com/2011/09/facebook-small3222.jpg";a:6:{s:8:"file_url";s:65:"http://fskelly.files.wordpress.com/2011/09/facebook-small3222.jpg";s:5:"width";s:2:"44";s:6:"height";s:2:"44";s:4:"type";s:5:"image";s:4:"area";s:4:"1936";s:9:"file_path";s:0:"";}s:64:"http://fskelly.files.wordpress.com/2011/09/twitter-small3222.jpg";a:6:{s:8:"file_url";s:64:"http://fskelly.files.wordpress.com/2011/09/twitter-small3222.jpg";s:5:"width";s:2:"44";s:6:"height";s:2:"44";s:4:"type";s:5:"image";s:4:"area";s:4:"1936";s:9:"file_path";s:0:"";}s:80:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color1.jpg";a:6:{s:8:"file_url";s:80:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color1.jpg";s:5:"width";s:3:"346";s:6:"height";s:3:"141";s:4:"type";s:5:"image";s:4:"area";s:5:"48786";s:9:"file_path";s:0:"";}s:86:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb1.jpg";a:6:{s:8:"file_url";s:86:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb1.jpg";s:5:"width";s:3:"244";s:6:"height";s:3:"102";s:4:"type";s:5:"image";s:4:"area";s:5:"24888";s:9:"file_path";s:0:"";}}s:6:"videos";a:0:{}s:11:"image_count";s:1:"6";s:6:"author";s:8:"17089368";s:7:"blog_id";s:8:"16477603";s:9:"mod_stamp";s:19:"2011-09-01 07:16:09";}'
  - 'a:7:{s:7:"primary";s:0:"";s:6:"images";a:6:{s:79:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color.jpg";a:6:{s:8:"file_url";s:79:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color.jpg";s:5:"width";s:3:"346";s:6:"height";s:3:"141";s:4:"type";s:5:"image";s:4:"area";s:5:"48786";s:9:"file_path";s:0:"";}s:85:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb.jpg";a:6:{s:8:"file_url";s:85:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb.jpg";s:5:"width";s:3:"244";s:6:"height";s:3:"102";s:4:"type";s:5:"image";s:4:"area";s:5:"24888";s:9:"file_path";s:0:"";}s:65:"http://fskelly.files.wordpress.com/2011/09/facebook-small3222.jpg";a:6:{s:8:"file_url";s:65:"http://fskelly.files.wordpress.com/2011/09/facebook-small3222.jpg";s:5:"width";s:2:"44";s:6:"height";s:2:"44";s:4:"type";s:5:"image";s:4:"area";s:4:"1936";s:9:"file_path";s:0:"";}s:64:"http://fskelly.files.wordpress.com/2011/09/twitter-small3222.jpg";a:6:{s:8:"file_url";s:64:"http://fskelly.files.wordpress.com/2011/09/twitter-small3222.jpg";s:5:"width";s:2:"44";s:6:"height";s:2:"44";s:4:"type";s:5:"image";s:4:"area";s:4:"1936";s:9:"file_path";s:0:"";}s:80:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color1.jpg";a:6:{s:8:"file_url";s:80:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color1.jpg";s:5:"width";s:3:"346";s:6:"height";s:3:"141";s:4:"type";s:5:"image";s:4:"area";s:5:"48786";s:9:"file_path";s:0:"";}s:86:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb1.jpg";a:6:{s:8:"file_url";s:86:"http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb1.jpg";s:5:"width";s:3:"244";s:6:"height";s:3:"102";s:4:"type";s:5:"image";s:4:"area";s:5:"24888";s:9:"file_path";s:0:"";}}s:6:"videos";a:0:{}s:11:"image_count";s:1:"6";s:6:"author";s:8:"17089368";s:7:"blog_id";s:8:"16477603";s:9:"mod_stamp";s:19:"2011-09-01 07:16:09";}'
categories:
  - Technology
tags:
  - Active Directory
  - Exchange
  - GPO
  - Group Policy
  - MCC
  - powershell
  - Receive Connector
  - Virtual Machine Manager
  - VMM

---
&#160;

Hi All,

It has been a really busy time for me. However, I am very happy with life at the moment. Just recently I received a “Microsoft Community Contributor” award from Microsoft.

[<img loading="lazy" style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="MCC_Logo_NEW" border="0" alt="MCC_Logo_NEW" src="http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb.jpg" width="244" height="102" />][1]

I know I have been a little quite the last little while. I have been busy doing a job that everyone loves (I wish there was a font for sarcasm). I have been VERY busy documenting my production environment including Hyper-V, Active Directory and Exchange. This is a long and tiresome process, however PowerShell has been a phenomenal help and I thought I would share a few bits of code from PowerShell that have made my life a little easier in this process.

**ACTIVE DIRECTORY**

A script to list all GPO in required Domain

> Import-Module grouppolicy  
> #command to get all GPOS  
> get-gpo -all -Domain domainname

<p align="left">
  A script to backup all GPOs for said domain
</p>

> Import-Module grouppolicy  
> #command to backup all GPOS  
> Backup-GPO -All -Domain domainname -Path filepath

**EXCHANGE**&#160;

A script to pull the IP address listed within a Receive Connector

> Add-PSSnapin Microsoft.Exchange.Management.PowerShell.E2010  
> Add-PSSnapin Microsoft.Exchange.Management.PowerShell.Support  
> Get-ReceiveConnector -Server <nameoripofHTServer>  
> Get-ReceiveConnector -Identity "<name of identity>" | Select-Object -ExpandProperty RemoteIPRanges

**VIRTUAL MACHINE MANAGER**

A script to pull the VMs being controlled by Virtual Machine manager and sort them by Host Name for easier documentation.

> Add-PSSnapin Microsoft.SystemCenter.VirtualMachineManager  
> Get-VMMServer nameofvmmserver  
> Get-VM -VMMServer nameofvmmserver | Select-Object -Property Name, Owner, Description, HostName, OperatingSystem, CPUCount, Memory | Sort-Object -Property HostName

Really hope this helps some other people as well.

Follow me

[<img loading="lazy" style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;margin:0;" title="facebook-small3222" border="0" alt="facebook-small3222" src="http://fskelly.files.wordpress.com/2011/09/facebook-small3222.jpg" width="44" height="44" />][2] [<img loading="lazy" style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="twitter-small3222" border="0" alt="twitter-small3222" src="http://fskelly.files.wordpress.com/2011/09/twitter-small3222.jpg" width="44" height="44" />][3]

[<img loading="lazy" style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="MCC_Logo_NEW" border="0" alt="MCC_Logo_NEW" src="http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color_thumb1.jpg" width="244" height="102" />][4]

 [1]: http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color.jpg
 [2]: http://www.facebook.com/fletcher.kelly
 [3]: http://twitter.com/#!/fskelly
 [4]: http://fskelly.files.wordpress.com/2011/09/mcc11_logo_horizontal_full-color1.jpg